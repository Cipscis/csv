{"version":3,"sources":["webpack:///webpack/bootstrap","webpack:///./csv.js","webpack:///./node_modules/activate/activate.js","webpack:///./docs/assets/js/src/main.js"],"names":["installedModules","__webpack_require__","moduleId","exports","module","i","l","modules","call","m","c","d","name","getter","o","Object","defineProperty","enumerable","get","r","Symbol","toStringTag","value","t","mode","__esModule","ns","create","key","bind","n","object","property","prototype","hasOwnProperty","p","s","stringify","parse","csv","data","options","transpose","sanitise","rows","_shape","_escape","_join","maxLength","reduce","row","Math","max","length","iMax","jMax","j","iRow","iCol","cellValue","push","match","replace","join","csvString","_tokenise","_validate","tokens","inQuote","wasQuote","tokenStart","char","comma","quote","newline","eof","Error","token","substring","rowLength","boundEvents","activate","deactivate","nodes","fn","_activator","_activateSingle","_deactivateSingle","activator","document","querySelectorAll","e","method","DOMException","Node","forEach","node","TypeError","_getNodeBindings","addEventListener","_isNodeType","_getNodeHasBindings","_preventSpacebarScroll","spacebarFn","_makeSpacebarFn","bindings","enterFn","_makeEnterFn","_rememberNodeBindings","removeEventListener","_forgetNodeBindings","nodeB","find","el","fnB","assign","fnBIndex","indexOf","splice","isEnter","_isEnter","apply","this","arguments","toLowerCase","target","isButton","isInput","isSpacebar","_isSpacebar","preventDefault","nodeTypes","map","nodeType","nodeName","includes","stringifyInput","test","parseInput","$input","querySelector","$output","$transpose","$sanitise","checked","str","innerHTML","JSON"],"mappings":"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","file":"bundle.js","sourcesContent":[" \t// The module cache\n \tvar installedModules = {};\n\n \t// The require function\n \tfunction __webpack_require__(moduleId) {\n\n \t\t// Check if module is in cache\n \t\tif(installedModules[moduleId]) {\n \t\t\treturn installedModules[moduleId].exports;\n \t\t}\n \t\t// Create a new module (and put it into the cache)\n \t\tvar module = installedModules[moduleId] = {\n \t\t\ti: moduleId,\n \t\t\tl: false,\n \t\t\texports: {}\n \t\t};\n\n \t\t// Execute the module function\n \t\tmodules[moduleId].call(module.exports, module, module.exports, __webpack_require__);\n\n \t\t// Flag the module as loaded\n \t\tmodule.l = true;\n\n \t\t// Return the exports of the module\n \t\treturn module.exports;\n \t}\n\n\n \t// expose the modules object (__webpack_modules__)\n \t__webpack_require__.m = modules;\n\n \t// expose the module cache\n \t__webpack_require__.c = installedModules;\n\n \t// define getter function for harmony exports\n \t__webpack_require__.d = function(exports, name, getter) {\n \t\tif(!__webpack_require__.o(exports, name)) {\n \t\t\tObject.defineProperty(exports, name, { enumerable: true, get: getter });\n \t\t}\n \t};\n\n \t// define __esModule on exports\n \t__webpack_require__.r = function(exports) {\n \t\tif(typeof Symbol !== 'undefined' && Symbol.toStringTag) {\n \t\t\tObject.defineProperty(exports, Symbol.toStringTag, { value: 'Module' });\n \t\t}\n \t\tObject.defineProperty(exports, '__esModule', { value: true });\n \t};\n\n \t// create a fake namespace object\n \t// mode & 1: value is a module id, require it\n \t// mode & 2: merge all properties of value into the ns\n \t// mode & 4: return value when already ns object\n \t// mode & 8|1: behave like require\n \t__webpack_require__.t = function(value, mode) {\n \t\tif(mode & 1) value = __webpack_require__(value);\n \t\tif(mode & 8) return value;\n \t\tif((mode & 4) && typeof value === 'object' && value && value.__esModule) return value;\n \t\tvar ns = Object.create(null);\n \t\t__webpack_require__.r(ns);\n \t\tObject.defineProperty(ns, 'default', { enumerable: true, value: value });\n \t\tif(mode & 2 && typeof value != 'string') for(var key in value) __webpack_require__.d(ns, key, function(key) { return value[key]; }.bind(null, key));\n \t\treturn ns;\n \t};\n\n \t// getDefaultExport function for compatibility with non-harmony modules\n \t__webpack_require__.n = function(module) {\n \t\tvar getter = module && module.__esModule ?\n \t\t\tfunction getDefault() { return module['default']; } :\n \t\t\tfunction getModuleExports() { return module; };\n \t\t__webpack_require__.d(getter, 'a', getter);\n \t\treturn getter;\n \t};\n\n \t// Object.prototype.hasOwnProperty.call\n \t__webpack_require__.o = function(object, property) { return Object.prototype.hasOwnProperty.call(object, property); };\n\n \t// __webpack_public_path__\n \t__webpack_require__.p = \"\";\n\n\n \t// Load entry module and return exports\n \treturn __webpack_require__(__webpack_require__.s = 0);\n","const { stringify, parse } = (() => {\n\tconst csv = {\n\t\tstringify: function (data, options) {\n\t\t\toptions = options || {};\n\t\t\toptions.transpose = options.transpose || false;\n\t\t\toptions.sanitise = options.sanitise || false;\n\n\t\t\t// Enforce square data and apply CSV escaping, then convert to string\n\t\t\tlet rows = data;\n\n\t\t\trows = csv._shape(data, options);\n\t\t\trows = csv._escape(rows, options);\n\n\t\t\trows = csv._join(rows);\n\n\t\t\treturn rows;\n\t\t},\n\n\t\t_shape: function (data, options) {\n\t\t\t// Pad missing cells with empty strings and,\n\t\t\t// if necessary, transpose the data\n\n\t\t\tconst transpose = options.transpose;\n\n\t\t\tconst maxLength = data.reduce((maxLength, row) => Math.max(maxLength, row.length), 0);\n\n\t\t\t// Flip rows and columns if transposing data\n\t\t\tconst iMax = transpose ? maxLength : data.length;\n\t\t\tconst jMax = transpose ? data.length : maxLength;\n\n\t\t\tlet rows = [];\n\t\t\tfor (let i = 0; i < iMax; i++) {\n\t\t\t\tlet row = [];\n\t\t\t\tfor (let j = 0; j < jMax; j++) {\n\t\t\t\t\tlet iRow = transpose ? j : i;\n\t\t\t\t\tlet iCol = transpose ? i : j;\n\n\t\t\t\t\tlet cellValue = data[iRow][iCol];\n\n\t\t\t\t\tif (iCol >= data[iRow].length) {\n\t\t\t\t\t\tcellValue = '';\n\t\t\t\t\t}\n\n\t\t\t\t\trow.push(cellValue);\n\t\t\t\t}\n\t\t\t\trows.push(row);\n\t\t\t}\n\n\t\t\treturn rows;\n\t\t},\n\n\t\t_escape: function (rows, options) {\n\t\t\t// Make sure any cells containing \" or , or a newline are escaped appropriately\n\n\t\t\tconst sanitise = options.sanitise;\n\n\t\t\tfor (let i = 0; i < rows.length; i++) {\n\t\t\t\tlet row = rows[i];\n\n\t\t\t\tfor (let j = 0; j < row.length; j++) {\n\t\t\t\t\tif (typeof row[j] === 'undefined') {\n\t\t\t\t\t\t// Replace undefined with ''\n\t\t\t\t\t\trow[j] = '';\n\t\t\t\t\t} else if (typeof row[j] !== 'string') {\n\t\t\t\t\t\t// Convert to string\n\t\t\t\t\t\trow[j] = '' + row[j];\n\t\t\t\t\t}\n\n\t\t\t\t\tif (sanitise) {\n\t\t\t\t\t\t// Prevent spreadsheet software like\n\t\t\t\t\t\t// Excel from trying to execute code\n\t\t\t\t\t\tif (row[j].match(/^[=\\-+@]/)) {\n\t\t\t\t\t\t\trow[j] = '\\t' + row[j];\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\n\t\t\t\t\tif (row[j].match(/,|\"|\\n/)) {\n\n\t\t\t\t\t\t// Turn any double quotes into escaped double quotes\n\t\t\t\t\t\trow[j] = row[j].replace(/\"/g, '\"\"');\n\n\t\t\t\t\t\t// Wrap cell in double quotes\n\t\t\t\t\t\trow[j] = '\"' + row[j] + '\"';\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\n\t\t\treturn rows;\n\t\t},\n\n\t\t_join: function (rows) {\n\t\t\tfor (let i = 0; i < rows.length; i++) {\n\t\t\t\trows[i] = rows[i].join(',');\n\t\t\t}\n\t\t\trows = rows.join('\\n');\n\n\t\t\treturn rows;\n\t\t},\n\n\n\t\tparse: function (csvString) {\n\t\t\tlet rows = csv._tokenise(csvString);\n\n\t\t\tcsv._validate(rows);\n\n\t\t\treturn rows;\n\t\t},\n\n\t\t_tokenise: function (csvString) {\n\t\t\t// Walk through each character and produce an array of tokens\n\n\t\t\tlet tokens = [];\n\n\t\t\t// Remove carriage returns\n\t\t\tcsvString = csvString.replace(/\\r/g, '');\n\n\t\t\tlet inQuote = false;\n\t\t\tlet wasQuote = false;\n\n\t\t\tlet tokenStart = 0;\n\t\t\tlet row = [];\n\t\t\tfor (let i = 0; i < csvString.length; i++) {\n\t\t\t\tlet char = csvString[i];\n\n\t\t\t\tlet comma = char === ',';\n\t\t\t\tlet quote = char === '\"';\n\t\t\t\tlet newline = char === '\\n';\n\t\t\t\tlet eof = i === csvString.length -1; // eof - End Of File\n\n\t\t\t\tif (inQuote) {\n\t\t\t\t\t// Characters may be delimited\n\t\t\t\t\tif (quote) {\n\t\t\t\t\t\t// Check if the next character is another double quote, i.e. if it is escaped\n\t\t\t\t\t\tlet nextChar = csvString[i+1];\n\n\t\t\t\t\t\tif (nextChar === '\"') {\n\t\t\t\t\t\t\t// This and the next character combined make an escaped double quote,\n\t\t\t\t\t\t\t// so the quote has not ended and we should skip over the next character\n\t\t\t\t\t\t\ti++;\n\t\t\t\t\t\t\tcontinue;\n\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\t// The quote has ended\n\t\t\t\t\t\t\tinQuote = false;\n\t\t\t\t\t\t\twasQuote = true;\n\n\t\t\t\t\t\t\tif (!eof) {\n\t\t\t\t\t\t\t\tcontinue;\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\t\t\t\t\t} else if (eof) {\n\t\t\t\t\t\tthrow new Error(`CSV parse: Reached end of file before ending quote. At index ${i}`);\n\t\t\t\t\t}\n\t\t\t\t}\n\n\t\t\t\tif (!inQuote && (comma || newline || eof)) {\n\t\t\t\t\t// These are the characters that denote the end of a token\n\t\t\t\t\tlet token = csvString.substring(tokenStart, i+1);\n\n\t\t\t\t\tif (comma || newline) {\n\t\t\t\t\t\t// Don't keep the separator\n\t\t\t\t\t\ttoken = token.substring(0, token.length - 1);\n\t\t\t\t\t}\n\n\t\t\t\t\tif (wasQuote) {\n\t\t\t\t\t\twasQuote = false;\n\n\t\t\t\t\t\t// Remove start and end quotes\n\t\t\t\t\t\ttoken = token.substring(1, token.length - 1);\n\n\t\t\t\t\t\t// Replace escaped quotes\n\t\t\t\t\t\ttoken = token.replace(/\"\"/g, '\"');\n\t\t\t\t\t}\n\t\t\t\t\trow.push(token);\n\n\t\t\t\t\tif (comma && eof) {\n\t\t\t\t\t\t// It's the end of the last token, and the last cell is empty\n\t\t\t\t\t\trow.push('');\n\t\t\t\t\t}\n\n\t\t\t\t\tif (newline || eof) {\n\t\t\t\t\t\ttokens.push(row);\n\t\t\t\t\t\tif (newline) {\n\t\t\t\t\t\t\trow = [];\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\n\t\t\t\t\ttokenStart = i+1;\n\t\t\t\t} else if (wasQuote) {\n\t\t\t\t\tthrow new Error(`CSV parse: A value must be complete immediately after closing a quote. At index ${i}`);\n\t\t\t\t} else if (quote) {\n\t\t\t\t\tinQuote = true;\n\t\t\t\t}\n\t\t\t}\n\n\t\t\treturn tokens;\n\t\t},\n\n\t\t_validate: function (rows) {\n\t\t\t// Each row of a CSV should have the same length;\n\n\t\t\tif (rows && rows.length > 1) {\n\t\t\t\tlet rowLength = rows[0].length;\n\t\t\t\tfor (let i = 1; i < rows.length; i++) {\n\t\t\t\t\tlet row = rows[i];\n\n\t\t\t\t\tif (row.length !== rowLength) {\n\t\t\t\t\t\tthrow new Error(`CSV parse: Row ${i} does not have the same length as the first row (${rowLength})`);\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t};\n\n\treturn {\n\t\tstringify: csv.stringify,\n\t\tparse: csv.parse,\n\t};\n})();\n\nexport { stringify, parse };\n","/* Activate 1.0.2 */\n\n// Binds event listeners to one or more elements that makes them behave\n// like buttons, detecting both \"click\" events and also keydown for\n// the \"Enter\" key and keyup for the \"Space\" key.\n\n// Example usage:\n// activate(nodeList, fn);\n// activate(singleNode, fn);\n// activate(selector, fn);\n\nconst boundEvents = [];\n/*\n[\n\t{\n\t\tnode: Node,\n\t\tbindings: [\n\t\t\t{\n\t\t\t\tfn: Function,\n\t\t\t\tspacebarFn: Function,\n\t\t\t\tenterFn: Function\n\t\t\t}\n\t\t]\n\t}\n]\n*/\n\nconst { activate, deactivate } = (function () {\n\tconst module = {\n\t\tactivate: function (nodes, fn) {\n\t\t\tmodule._activator(nodes, fn, module._activateSingle);\n\t\t},\n\n\t\tdeactivate: function (nodes, fn) {\n\t\t\tmodule._activator(nodes, fn, module._deactivateSingle);\n\t\t},\n\n\t\t_activator: function (nodes, fn, activator) {\n\t\t\t// Share the same initial logic between activate and deactivate,\n\t\t\t// but run a different function over each node\n\n\t\t\tif (typeof nodes === 'string') {\n\t\t\t\ttry {\n\t\t\t\t\tnodes = document.querySelectorAll(nodes);\n\t\t\t\t} catch (e) {\n\t\t\t\t\tlet method = activator === module._deactivateSingle ? 'deactivate' : 'activate';\n\t\t\t\t\tthrow new DOMException(`${method} failed because it was passed an invalid selector string: '${nodes}'`);\n\t\t\t\t}\n\t\t\t}\n\n\t\t\tif (nodes instanceof Node) {\n\t\t\t\tactivator(nodes, fn);\n\t\t\t} else if (nodes.length && nodes.forEach) {\n\t\t\t\tnodes.forEach((node) => activator(node, fn));\n\t\t\t}\n\t\t},\n\n\n\n\t\t_activateSingle: function (node, fn) {\n\t\t\tif ((node instanceof Node === false)) {\n\t\t\t\tthrow new TypeError(`activate failed because a valid Node was not passed`);\n\t\t\t}\n\n\t\t\tif (module._getNodeBindings(node, fn)) {\n\t\t\t\t// Like addEventListener, don't try to rebind new copies of the same events\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\t// All nodes should bind the click event\n\t\t\tnode.addEventListener('click', fn);\n\n\t\t\t// Buttons will already treat keyboard events like clicks,\n\t\t\t// so only bind them to other node types\n\t\t\tlet isButton = module._isNodeType(node, 'button');\n\t\t\tif (isButton === false) {\n\t\t\t\tif (module._getNodeHasBindings(node) === false) {\n\t\t\t\t\t// addEventListener would prevent this event being\n\t\t\t\t\t// bound multiple times, but be explicit that it is\n\t\t\t\t\t// only bound if the node has no other events bound\n\t\t\t\t\tnode.addEventListener('keydown', module._preventSpacebarScroll);\n\t\t\t\t}\n\n\t\t\t\tlet spacebarFn = module._makeSpacebarFn(fn);\n\t\t\t\tnode.addEventListener('keyup', spacebarFn);\n\t\t\t\tlet bindings = {\n\t\t\t\t\tspacebarFn\n\t\t\t\t};\n\n\t\t\t\t// Links already treat \"enter\" keydown like a click\n\t\t\t\tlet isLink = module._isNodeType(node, 'a');\n\t\t\t\tif (isLink === false) {\n\t\t\t\t\t// Note that holding down \"enter\" will behave differently\n\t\t\t\t\t// for links in that it will only fire once, whereas for\n\t\t\t\t\t// non-links, including buttons, it will fire multiple times\n\t\t\t\t\tlet enterFn = module._makeEnterFn(fn);\n\t\t\t\t\tnode.addEventListener('keydown', enterFn);\n\t\t\t\t\tbindings.enterFn = enterFn;\n\t\t\t\t}\n\n\t\t\t\tmodule._rememberNodeBindings(node, fn, bindings);\n\t\t\t}\n\t\t},\n\n\t\t_deactivateSingle: function (node, fn) {\n\t\t\tif ((node instanceof Node === false)) {\n\t\t\t\tthrow new TypeError(`deactivate failed because a valid Node was not passed`);\n\t\t\t}\n\n\t\t\tlet bindings = module._getNodeBindings(node, fn);\n\n\t\t\t// All nodes have had a click event bound\n\t\t\tnode.removeEventListener('click', fn);\n\n\t\t\tif (!bindings) {\n\t\t\t\t// No other events to unbind\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\t// Buttons will already treat keyboard events like clicks,\n\t\t\t// so they didn't have keyboard events bound to them\n\t\t\tlet isButton = module._isNodeType(node, 'button');\n\t\t\tif (isButton === false) {\n\t\t\t\tnode.removeEventListener('keyup', bindings.spacebarFn);\n\n\t\t\t\t// Links already treat \"enter\" keydown like a click,\n\t\t\t\t// so that event wasn't bound to them\n\t\t\t\tlet isLink = module._isNodeType(node, 'a');\n\t\t\t\tif (isLink === false) {\n\t\t\t\t\tnode.removeEventListener('keydown', bindings.enterFn);\n\t\t\t\t}\n\n\t\t\t\tmodule._forgetNodeBindings(node, fn);\n\n\t\t\t\tif (module._getNodeHasBindings(node) === false) {\n\t\t\t\t\t// Only unbind this event if the node has no other bindings\n\t\t\t\t\tnode.removeEventListener('keydown', module._preventSpacebarScroll);\n\t\t\t\t}\n\t\t\t}\n\t\t},\n\n\n\n\t\t_rememberNodeBindings: function (node, fn, bindings) {\n\t\t\tlet nodeB = boundEvents.find(el => el.node === node);\n\t\t\tif (!nodeB) {\n\t\t\t\tnodeB = {\n\t\t\t\t\tnode: node,\n\t\t\t\t\tbindings: [\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\tfn\n\t\t\t\t\t\t}\n\t\t\t\t\t]\n\t\t\t\t};\n\t\t\t\tboundEvents.push(nodeB);\n\t\t\t}\n\n\t\t\tlet fnB = nodeB.bindings.find(el => el.fn === fn);\n\t\t\tif (!fnB) {\n\t\t\t\tfnB = {\n\t\t\t\t\tfn\n\t\t\t\t};\n\t\t\t\tnodeB.bindings.push(fnB);\n\t\t\t}\n\n\t\t\tObject.assign(fnB, bindings);\n\t\t},\n\n\t\t_forgetNodeBindings: function (node, fn) {\n\t\t\tlet nodeB = boundEvents.find(el => el.node === node);\n\t\t\tif (!nodeB) {\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tlet fnB = nodeB.bindings.find(el => el.fn === fn);\n\t\t\tif (!fnB) {\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tlet fnBIndex = nodeB.bindings.indexOf(fnB);\n\n\t\t\tnodeB.bindings.splice(fnBIndex, 1);\n\t\t},\n\n\t\t_getNodeBindings: function (node, fn) {\n\t\t\tlet nodeB = boundEvents.find(el => el.node === node);\n\t\t\tif (!nodeB) {\n\t\t\t\treturn undefined;\n\t\t\t}\n\n\t\t\tlet fnB = nodeB.bindings.find(el => el.fn === fn);\n\t\t\tif (!fnB) {\n\t\t\t\treturn undefined;\n\t\t\t}\n\n\t\t\treturn fnB;\n\t\t},\n\n\t\t_getNodeHasBindings: function (node) {\n\t\t\tlet nodeB = boundEvents.find(el => el.node === node);\n\t\t\treturn !!nodeB;\n\t\t},\n\n\n\n\t\t_makeEnterFn: function (fn) {\n\t\t\treturn function (e) {\n\t\t\t\tlet isEnter = module._isEnter(e);\n\n\t\t\t\tif (isEnter) {\n\t\t\t\t\tfn.apply(this, arguments);\n\t\t\t\t}\n\t\t\t};\n\t\t},\n\n\t\t_isEnter: function (e) {\n\t\t\tlet isEnter = e.key && (e.key.toLowerCase() === 'enter');\n\n\t\t\treturn isEnter;\n\t\t},\n\n\n\n\t\t_preventSpacebarScroll: function (e) {\n\t\t\t// Prevent spacebar from scrolling the page down on keydown\n\t\t\tlet node = e.target;\n\n\t\t\tlet isButton = module._isNodeType(node, 'button');\n\t\t\tlet isInput = module._isNodeType(node, 'input', 'textarea');\n\n\t\t\tlet isSpacebar = module._isSpacebar(e);\n\n\t\t\tif (!isButton && !isInput && isSpacebar) {\n\t\t\t\te.preventDefault();\n\t\t\t}\n\t\t},\n\n\t\t_makeSpacebarFn: function (fn) {\n\t\t\treturn function (e) {\n\t\t\t\tlet isSpacebar = module._isSpacebar(e);\n\n\t\t\t\tif (isSpacebar) {\n\t\t\t\t\tfn.apply(this, arguments);\n\t\t\t\t}\n\t\t\t};\n\t\t},\n\n\t\t_isSpacebar: function (e) {\n\t\t\t// IE11 uses 'spacebar' instead of ' '\n\t\t\tlet isSpacebar = e.key && (e.key === ' ' || e.key.toLowerCase() === 'spacebar');\n\n\t\t\treturn isSpacebar;\n\t\t},\n\n\n\n\t\t_isNodeType: function (node, ...nodeTypes) {\n\t\t\tnodeTypes = nodeTypes.map(el => el.toLowerCase());\n\n\t\t\tlet nodeType = node.nodeName.toLowerCase();\n\t\t\tlet isOfType = nodeTypes.includes(nodeType);\n\n\t\t\treturn isOfType;\n\t\t}\n\t};\n\n\treturn {\n\t\tactivate: module.activate,\n\t\tdeactivate: module.deactivate\n\t};\n})();\n\nexport { activate, deactivate };\nexport default activate;\n","import { stringify, parse } from '/csv';\nimport { activate } from 'activate';\n\nconst stringifyInput = [\n\t['Numbers', 0, 1, 2, 3],\n\t['Test values', 'test', {test: true}],\n\t['Falsey values', false, '', [], null],\n\t['Values to sanitise', '=GET(malicious_code)', '-FETCH(url)', '+DO(nefarious_thing)', '@POST(data)'],\n];\n\nconst parseInput = `Numbers,0,1,2,3\nTest values,test,{test: true},,\nFalsey values,false,'',[],null\nValues to sanitise,=GET(malicious_code),-FETCH(url),+DO(nefarious_thing),@POST(data)`;\n\nactivate('.js-stringify__button', () => {\n\tlet $input = document.querySelector('.js-stringify__input');\n\tlet $output = document.querySelector('.js-stringify__output');\n\n\tlet $transpose = document.querySelector('.js-stringify__transpose');\n\tlet $sanitise = document.querySelector('.js-stringify__sanitise');\n\n\tlet options = {\n\t\ttranspose: $transpose.checked,\n\t\tsanitise: $sanitise.checked,\n\t};\n\n\tlet str = stringify(stringifyInput, options);\n\n\t$input.innerHTML = JSON.stringify(stringifyInput, null, '\\t');\n\t$output.innerHTML = str;\n});\n\nactivate('.js-parse__button', () => {\n\tlet $input = document.querySelector('.js-parse__input');\n\tlet $output = document.querySelector('.js-parse__output');\n\n\tlet data = parse(parseInput);\n\n\t$input.innerHTML = parseInput;\n\t$output.innerHTML = JSON.stringify(data, null, '\\t');\n});\n"],"sourceRoot":""}